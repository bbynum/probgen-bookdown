# Case Studies {#case_studies}

This chapter will later be split into seperate chapters are relocated.

```{r, message=FALSE, warning=FALSE, echo=FALSE}
library(mosaic)
set.seed(2018)
```

## Roulette

## Chapter Scenario - Conservative or Playa? {#chapter_scenario_conservative_or_playa}

Suppose that you have $100 to make one bet. Would you make an even money bet, like a bet on red that pays 1 to 1 or a single number bet, say on the lucky number 7, that pays off at 35 to 1 if a seven comes up? Discuss which bet appeals most to you and why.

## The Rules of Roulette {#the_rules_of_roulette}

To play roulette you place a bet and spin the wheel. If the wheel matches your bet you win; if not, you lose. Remember that a roulette wheel contains slots numbered 1 through 36, half of them red, half black and green 0 and 00 slots.  The table layout and payout schedule are below.

```{r nice-fig-171, fig.cap='American Roulette Wheel and Layout', out.width='30%', fig.asp=.75, fig.align='center', echo=FALSE}
knitr::include_graphics("01-basics-figures/roulette_american_layout.png")
```

For fun, view a simulation of roulette at 
http://www.flash-game.net/game/534/flash-roulette.html 

Note that European roulette as played in Monte Carlo only has the green zero and not the green double zero and thus the probabilities and expectations are different. There are also some minor differences in the rules. See the exercise at the end of the chapter. 

The payoff odds vary depending on your bet. The harder it is to win your bet, the greater the payoff odds. The payoff odds are shown in the table 

```{r nice-fig-172, fig.cap='Roulette Payoff Odds', out.width='30%', fig.asp=.75, fig.align='center', echo=FALSE}
knitr::include_graphics("01-basics-figures/roulette_payoff_odds.png")
```

Each player at the table will have different color chips and may make several bets at once by placing their chips in the right location as shown below.

```{r nice-fig-173, fig.cap='Roulette Bet Positions', out.width='30%', fig.asp=.75, fig.align='center', echo=FALSE}
knitr::include_graphics("01-basics-figures/roulette_bet_positions.png")
```

## Analyzing the Even-Money Bets {#analyzing_the_even_money_bets}
First, examine an even money bet, such as a $\$100$ bet on Red. The payout for Red bet is 1 to 1 meaning if you win you win $\$1$ for every $\$1$ bet. The probability distribution describing this bet is as follows. Since there are 18 red slots on the wheel the probability of winning a red bet is 18/38 while the probability of winning a single number bet is 1/38. If we let X represent the winnings the list of all the possible outcomes matched with their associated probabilities P(X) is called the probability distribution.

```{r nice-fig-174, fig.cap='Roulette Even Money Disribution', out.width='30%', fig.asp=.75, fig.align='center', echo=FALSE}
knitr::include_graphics("01-basics-figures/roulette_even_money_distribution.png")
```

The sum of the X*P(X) is  - 5.26 thus the expected payoff for a $100 bet on Red is to lose about five dollars and a quarter.

## Roulette Simulation

Considering a $\$100$ even-money roulette bet, such as a red bet, we can simulate a large number of trials noting the two outcomes or $-\$100$ or $+\$100$ with probabilities $20/38$ and $18/38$, respectively.

```{r}
red_bet <- sample(x=c(-100,100), prob=c(20/38,18/38),size=10000, replace = TRUE)
red_bet_df <- data.frame(red_bet)
head(red_bet)
```

We can examine the histogram.

```{r nice-fig-175, fig.cap='Histogram for Tossing One Die', out.width='80%', fig.asp=.75, fig.align='center'}
ggplot(data=red_bet_df, aes(x=red_bet)) + geom_histogram(aes(y=..density..), binwidth = 10)
```

It is not very interesting but we can identify whether we won more often or lost more often. In this case, we lost more often than we won and summary statistics can tell us the average amount lost.

```{r}
favstats(red_bet, data=red_bet_df)
```

For our simulation of 10,000 trials of $\$100$ red bet, our mean was $-\$6.52$, a little worse than our theoretical expectation of $-\$5.26$. Note also the standard deviation is $99.79$ which makes sense given the typical deviation on either side of the mean is around $100$.

## Analyzing the Single Number Bet

Consider a long shot single number bet, such as a $\$100$ bet on the number 7. The single number bet (called a “straight”) has a payout of 35 to 1 meaning if you win you win $\$35$ for every $\$1$ bet. There is only one way to win so the probability of winning is 1/38. We complete the table below to find the probability distribution and expected value for $\$100$ bet on a single number.

```{r nice-fig-176, fig.cap='Roulette Single Number Disribution', out.width='30%', fig.asp=.75, fig.align='center', echo=FALSE}
knitr::include_graphics("01-basics-figures/roulette_single_number_distribution.png")
```

The expectation is $-\$5.26$. Let's see how a simulation compares modifying the distribution values and probabilities. 

```{r}
single_bet <- sample(x=c(-100,3500), prob=c(37/38,1/38),size=10000, replace = TRUE)
single_bet_df <- data.frame(single_bet)
head(single_bet)
```

Examining the histogram we see that wins are few and far between (but remember the payoff is awesome when it happens).

```{r nice-fig-177, fig.cap='Histogram for Tossing One Die', out.width='80%', fig.asp=.75, fig.align='center'}
ggplot(data=single_bet_df, aes(x=single_bet)) + geom_histogram(aes(y=..density..), binwidth = 50)
```

We really need to run summary statistics to find the mean amount won or lost in our simulation

```{r}
favstats(single_bet, data=single_bet_df)
```

For our simulation of 10,000 trials of $\$100$ bet on a single number, our mean was $+\$8.36$. Wow. We came out a winner and actually won $10000 \cdot 8.63=86,300$ dollars though may not be as lucky next time. Note, also the standard deviation is $615.14$ which is more than six times larger than the standard deviation for a $\$100$ even-money bet.


## Exercises {#exercises}

### Exercise - Four and Five Number Bets

(a) Determine the expectation for a $\$100$ bet on four numbers.
(b) Determine the expectation for a $\$100$ bet on five numbers.
(c) Which of these bets has the more favorable expectation?

### Exercise - Simulating a Roulette Bet
Select one of the roulette bets not yet analyzed and consider a $\$100$ bet. 
(a) Determine the expectation for this bet.
(b) Run a simulation of at least 1000 trials of this bet, visualize the results with a histogram, and find the mean amount won/lost.
(c) How similar or different was the theoretical expectation from the simulated mean?


### Exercise - The Rule of 36
One nice rule for determining the roulette payoffs is the following formula we’ll call the Rule of 36: **The payoff ratio plus one all multiplied by the number of ways you can win the bet always equals 36.**

(a) Write the Rule of 36 symbolically letting N be the number of ways to win your bet and X being the payoff ratio.
(b) Use the Rule of 36 to confirm the payoff odds for following bets - single number (straight up), two number (split), three number (street), four number (corner), five number (basket) NB: round down!, six number (line), and twelve number (column, dozen). 


### Exercise - European Roulette
European roulette as played in Monte Carlo, for example, is different than American roulette. In European roulette there is only a single zero…no double zero. In addition, in an even money bet such as a bet on red, if the ball lands on the green 0 on the first spin, then your bet is put “in prison” and gets to stay there one more round. In such a case, on the second round, if one of your spots comes up, instead of losing you get your bet back and on any other spot you lose. Here we examine the difference the single zero and the “in prison” rule has on the expectation.

```{r nice-fig-178, fig.cap='European Roulette Wheel and Layout', out.width='30%', fig.asp=.75, fig.align='center', echo=FALSE}
knitr::include_graphics("01-basics-figures/roulette_european_layout.png")
```

(a) Suppose that you have $\$100$ to make one bet. Calculate the expected value for a $\$100$ bet on Red on a single-zero wheel with the “in prison” rule. To do so, you need to find the probabilities associated with three possible outcomes - you lose $\$100$ if you get black, you break even if you get 0 and then a red, you win $\$100$ if you get red.
(b) Recall the expected payoff on an even-money bet American double-zero wheel is $-\$5.26$. Is the expectation on a European single-zero wheel the same, more negative, or less negative? 
(c) Determine the expectation for one of the other bets (there is no in prison rule for the non-even-money bets). Is it the same, more negative, or less negative than the corresponding bet in American roulette?

## Craps

```{r, message=FALSE, warning=FALSE, echo=FALSE}
library(mosaic)
set.seed(2018)
```

## Chapter Scenario - Getting Six the Hard Way {#chapter_scenario_getting_six_the_hard_way}

In the game of craps, players can make a plethora of bets on the outcome of two dice. See the craps layout below.

```{r nice-fig-179, fig.cap='Craps Layout', out.width='30%', fig.asp=.75, fig.align='center', echo=FALSE}
knitr::include_graphics("01-basics-figures/craps_layout.png")
```

Some bets are single-roll bets, resolved with one toss of the dice, and others are multi-roll bets, where it may take many rolls before the bet is decided. One of the multi-roll bets is the Hardway 6. To win this bet you have to roll a sum of six the hard way, that is, with double-threes, before rolling a sum of six the easy way (1,5 or 2,4) or before rolling a sum of seven. This bet has a payoff of 9:1. What is the probability of winning this bet and what is the expectation?

## Single Roll Craps Bets

Some craps bets are single roll bets, resolved in one toss of the dice. For example, one can make the Eleven or Five Six bet. If a sum of 11 comes up you win. Otherwise, you lose. The payoff is 15:1. Examining the sample space for dice there are 2 ways to win and 34 ways to lose, thus, $P(win \ eleven \ bet)=2/36$ and $P(lose \ eleven \ bet)=34/36$. We can calculate the expectation on the eleven bet assuming a $\$1$ bet.

$$Mean= 15 \cdot \frac{2}{36}+(-1) \cdot \frac{34}{36}=\frac{-4}{36}=-0.111$$

Thus, we expect to lose 11.1 cents on average for every 1 dollar bet on the eleven bet, an $11.1\%$ house advantage.

## The Craps Passline Bet Explained

The heart of craps is the passline bet. The player rolling the dice must make this bet and other players around the table may join her (or, to be contrary, may bet against her). The passline bet pays off at even money, 1:1, and is potentially a multi-roll bet. The first roll of the dice on the passline bet is called the come out roll and you win on this first roll if you roll a sum of 7 or 11 (this is called a natural) and you lose on the first roll if you roll a sum of 2, 3, or 12 (this is called craps). It helps to have an image of the sample space for rolling two dice handy. 

```{r nice-fig-1710, fig.cap='Sample Space for Two Dice', out.width='30%', fig.asp=.75, fig.align='center', echo=FALSE}
knitr::include_graphics("01-basics-figures/sample_space_two_dice.png")
```

$$P(natural)=P(7 \ or \ 11)=P(7)+P(11)=6/36+2/36=8/36$$
$$P(craps)=P(2 \ or \ 3 \ or \ 12)=P(2)+P(3)+P(12)=1/36+2/36+1/36=4/36$$
You are twice as likely to win on the come out roll as to lose but notice most of the time (1-8/36-4/36=24/36) you neither win nor lose. In these cases, the sum you roll on the come out roll is established as the "point", thus, the sum you roll (4, 5, 6, 8, 9, or 10) is the point and now to win you must roll this sum again before rolling a sum of seven. If you do, this is called passing. If you roll the sum of seven before you roll your first sum again, then you lose.

We need to determine the probability of winning (ie., passing) in all of these different cases. Let's start with the case you roll a sum of 4. In the original two dice sample space below we have circled the outcomes that resolve this bet. 

```{r nice-fig-1711, fig.cap='Sample Space for Two Dice for a Point of Four', out.width='30%', fig.asp=.75, fig.align='center', echo=FALSE}
#knitr::include_graphics("01-basics-figures/sample_space_two_dice_point_of_four.png")
```

Since these 9 outcomes are the only ones that resolve the bet, we will ignore all occurrences of other sums and use these 9 outcomes as our new sample space as shown below. 

```{r nice-fig-1712, fig.cap='Sample Space for a Point of Four', out.width='30%', fig.asp=.75, fig.align='center', echo=FALSE}
#knitr::include_graphics("01-basics-figures/craps_sample_space_point_of_four.png")
```

Since there are three ways to win and six ways to lose, 

$$P(passing \mid point \ of \ four) = 3/9$$ 
and 
$$P(not \ passing \mid point \ of \ four) = 6/9$$

With a similar analysis, we can determine the probability of passing and of not passing for points of 5, 6, 8, 9, and 10. These values are shown in the table below.

```{r nice-fig-1713, fig.cap='Passing and Not Passing for Different Points', out.width='30%', fig.asp=.75, fig.align='center', echo=FALSE}
#knitr::include_graphics("01-basics-figures/craps_passing_and_not_passing_for_different_points.png")
```

To find the probability of winning on a passline bet we need to examine all of these cases. Here is how we can partition winning on the passline bet.

$$P(win \ passline)=P(natural)+P(4 \ and \ pass) + P(5 \ and \ pass)+ \\ 
P(6 \ and \ pass)+P(8 \ and\ pass)+P(9 \ and \ pass)+p(10 \ and \ pass)= \\
P(natural)+P(4)P(pass \mid 4)+P(5)P(pass \mid 5)+P(6)P(pass \mid 6) \\ +P(8)P(pass \mid 8)+P(9)P(pass \mid 9)+P(10)P(pass \mid 10) = \\
4/36+(3/36)(3/36)+(4/36)(4/10)+(5/36)(5/11)+(5/36)(5/11)+(4/36)(4/10)+(3/36)(3/36)$$

It is now easy to determine the probability of losing the passline bet.

$$P(losing \ passline) = 1 - P(winning \ passline) = 1 - 0.493=0.507$$

We are now in position to find the expectation. Let's assume $\$1$ is bet on the passline. Note, there are no casinos allowing this small of a bet. Often the minimum is $\$5$.

$$Mean= (+1) \cdot 0.493 + (-1) \cdot 0.507 = -0.0140$$
This means that we lose about 1.4 cents for each dollar bet on the passline. This is a $1.4\%$ house advantage.

## Chapter Scenario Revisited - Getting Six the Hard Way {#chapter_scenario_revisited_getting_six_the_hard_way}

Recall, we win a Hardway Six bet by rolling six the hard way with double threes before rolling a six any other way or rolling a seven. The payoff is 9:1. Out of the eleven different ways this bet is resolved as shown in the image below, there is only one way to win. 

```{r nice-fig-1714, fig.cap='The Hardway Six Sample Space', out.width='30%', fig.asp=.75, fig.align='center', echo=FALSE}
#knitr::include_graphics("01-basics-figures/craps_hardway_six_sample_space.png")
```

Thus, $P(win Hardway Six)=1/11$ and $P(lose Hardway Six)=10/11$. We find the expectation below

$$Mean= (+9) \cdot \frac{1}{11} + (-1) \cdot \frac{10}{11}= \frac{-1}{11}=-0.0909$$

On average, on the Hardway Six we lose about 9 cents per dollar bet for a house advantage of $9.09\%$.

## Exercises

### Exercise - Single Roll Bet
Find the expected value on the Aces bet, a single roll bet where double ones is a winner and everything else is a loser. This bet pays off at 30:1.

### Exercise - Multi-roll Bet
The Hardway Four bet pays off at 7:1. You win if you roll a sum of four the hardway (double two's) and you lose if you roll a sum of four any other way or roll a sum of seven. Find the expected value.

### Exercise - The Don't Pass Bet
The Don't Pass Bet has payoff odds of 1:1 is almost the opposite of the Passline Bet as described below.

* Roll a 2 or 3 on first roll and win.
* Roll a 12 on first roll and get your money back (this is called BAR 12).
*	Roll a 7 or 11 on first roll and lose.
* Roll anything else and this becomes the point.
* Roll a 7 before the point and win.
* Roll the point before 7 and lose.

Find the expected value of a $\$1$ bet on Don't Pass. Be sure to factor in that when 12 is rolled on the come out roll you get your money back and break even.

### Exercise - Free Odds
When a point is established a pass line player may place a bet equal to the original bet on the point paying off at the true odds of that point passing.  
(a) Determine true odds for each possible point - 4, 5, 6, 8, 9, 10. That is, determine the payoff odds that would result in a fair bet with expected value of 0. 
(b) Consider a $\$10$ passline bet with a $\$10$ free odds bet taken whenever possible. The expected value for a $\$10$ passline bet is -0.140. Given that the additional odds bet is a fair bet, what would the expectation be on the $\$10$ passline bet with $\$10$ free odds taken whenever possible? Explain.




